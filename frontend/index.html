<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X - Who Said What?</title>
    <style>
        /* --- RESET & VARIABLES --- */
        :root {
            --bg-color: #000000;
            --bg-dim: #0f1419;
            --border-color: #2f3336;
            --text-main: #e7e9ea;
            --text-secondary: #71767b;
            --accent-blue: #1d9bf0;
            --accent-blue-hover: #1a8cd8;
            --card-hover: rgba(255, 255, 255, 0.03);
            --red-like: #f91880;
            --green-retweet: #00ba7c;
            --font-stack: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            --glass-bg: rgba(0, 0, 0, 0.65);
            --glass-border: 1px solid rgba(255, 255, 255, 0.08);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font-stack);
            overflow-y: scroll;
            height: 100vh;
        }

        a { text-decoration: none; color: inherit; }
        ul { list-style: none; }
        button { border: none; background: none; cursor: pointer; font-family: inherit; }

        /* --- LAYOUT GRID --- */
        .layout {
            display: grid;
            grid-template-columns: 240px minmax(0, 1fr) 300px; /* Sidebar | Feed | Widgets */
            gap: 0;
            max-width: 1250px;
            margin: 0 auto;
            min-height: 100vh;
            padding: 12px;
        }

        /* Medium screens: reduce sidebars */
        @media (max-width: 1100px) {
            .layout { grid-template-columns: 88px minmax(0, 1fr) 260px; }
            .nav-label { display: none; }
            .tweet-btn-large { display: none; }
            .tweet-btn-icon { display: block !important; }
        }

        /* Narrow screens: hide right widgets */
        @media (max-width: 900px) {
            .layout { grid-template-columns: 88px 1fr; grid-auto-columns: 0; }
            .right-sidebar { display: none; }
        }

        /* Mobile: single column feed, bottom navigation */
        @media (max-width: 600px) {
            .layout { grid-template-columns: 1fr; padding: 8px; }
            .left-sidebar { 
                position: fixed; bottom: 0; left: 0; right: 0; height: 60px; 
                flex-direction: row; justify-content: space-around; 
                background: var(--bg-color); border-top: 1px solid var(--border-color);
                padding: 0; z-index: 100;
            }
            .logo-box { display: none; }
            .nav-item { padding: 10px; }
            .main-feed { border: none; margin-bottom: 70px; }
            .right-sidebar { display: none; }
        }

        /* --- LEFT SIDEBAR --- */
        .left-sidebar {
            position: sticky;
            top: 0;
            height: 100vh;
            padding: 0 12px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .nav-links { margin-top: 10px; }
        
        .logo-box {
            padding: 12px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
        }
        .logo-box:hover { background-color: rgba(29, 155, 240, 0.1); }
        .logo-svg { fill: var(--text-main); width: 30px; height: 30px; }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 30px;
            margin-bottom: 4px;
            transition: 0.2s;
            color: var(--text-main);
            font-size: 20px;
        }
        .nav-item:hover { background-color: var(--card-hover); }
        .nav-item.active { font-weight: 700; }
        .nav-icon { width: 26px; height: 26px; margin-right: 20px; fill: currentColor; }
        
        .tweet-btn-large {
            background-color: var(--accent-blue);
            color: white;
            font-weight: 700;
            font-size: 17px;
            padding: 15px 0;
            border-radius: 30px;
            width: 90%;
            margin-top: 15px;
            transition: 0.2s;
            box-shadow: 0 4px 10px rgba(29, 155, 240, 0.3);
        }
        .tweet-btn-large:hover { background-color: var(--accent-blue-hover); }
        .tweet-btn-icon {
            display: none;
            width: 50px; height: 50px;
            border-radius: 50%;
            background-color: var(--accent-blue);
            margin-top: 15px;
            fill: white;
            padding: 12px;
        }

        /* --- MAIN FEED --- */
        .main-feed {
            border-left: 1px solid var(--border-color);
            border-right: 1px solid var(--border-color);
            position: relative;
        }

        .feed-header {
            position: sticky;
            top: 0;
            background: rgba(0, 0, 0, 0.65);
            backdrop-filter: blur(12px);
            z-index: 10;
            border-bottom: 1px solid var(--border-color);
        }
        
        .header-top {
            padding: 12px 16px;
            font-weight: 700;
            font-size: 20px;
        }

        .header-tabs {
            display: flex;
            justify-content: space-around;
        }
        
        .tab-item {
            flex: 1;
            text-align: center;
            padding: 16px 0;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            position: relative;
            transition: 0.2s;
        }
        .tab-item:hover { background-color: var(--card-hover); }
        .tab-item.active { color: var(--text-main); }
        .tab-indicator {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 4px;
            background-color: var(--accent-blue);
            border-radius: 2px;
            display: none;
        }
        .tab-item.active .tab-indicator { display: block; }

        /* Compose Box */
        .compose-box {
            padding: 16px;
            display: flex;
            border-bottom: 1px solid var(--border-color);
        }
        .user-avatar {
            width: clamp(36px, 5.6vw, 56px);
            height: clamp(36px, 5.6vw, 56px);
            border-radius: 50%;
            background-color: #333;
            object-fit: cover;
            margin-right: 12px;
            flex-shrink: 0;
        }
        .compose-right { flex: 1; }
        .compose-input {
            width: 100%;
            background: transparent;
            border: none;
            color: var(--text-main);
            font-size: 20px;
            outline: none;
            resize: none;
            min-height: 50px;
            padding: 10px 0;
            font-family: var(--font-stack);
        }
        .compose-input::placeholder { color: var(--text-secondary); }
        
        .compose-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 10px;
        }
        .compose-icons svg {
            width: 20px; height: 20px;
            fill: var(--accent-blue);
            margin-right: 12px;
            cursor: pointer;
            padding: 8px;
            box-sizing: content-box;
            border-radius: 50%;
            transition: 0.2s;
        }
        .compose-icons svg:hover { background-color: rgba(29, 155, 240, 0.1); }

        .post-btn {
            background-color: var(--accent-blue);
            color: white;
            font-weight: 700;
            padding: 8px 16px;
            border-radius: 20px;
            opacity: 0.5;
            pointer-events: none;
            transition: 0.2s;
        }
        .post-btn.active { opacity: 1; pointer-events: auto; }

        /* Feed Items */
        .tweet {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            gap: 12px;
            cursor: pointer;
            transition: 0.2s;
            position: relative;
            align-items: flex-start;
        }
        .tweet:hover { background-color: rgba(255, 255, 255, 0.02); }
        
        /* Thread / Reply Connector Line */
        .thread-line {
            position: absolute;
            left: 36px; /* center of 40px avatar + 16px pad */
            top: 52px;
            bottom: -12px;
            width: 2px;
            background-color: var(--border-color);
            z-index: 0;
        }
        .tweet.reply { border-top: none; }

        .tweet-content { flex: 1; margin-left: 0; z-index: 1; }
        .tweet-header {
            display: flex;
            align-items: baseline;
            margin-bottom: 4px;
        }
        .user-name { font-weight: 700; color: var(--text-main); margin-right: 5px; }
        .user-handle { color: var(--text-secondary); margin-right: 5px; }
        .time { color: var(--text-secondary); }
        .tweet-text {
            font-size: 15px;
            line-height: 1.5;
            color: var(--text-main);
            margin-bottom: 12px;
            white-space: pre-wrap;
        }
        
        .tweet-actions {
            display: flex;
            justify-content: space-between;
            max-width: 425px;
            color: var(--text-secondary);
        }
        .action-item {
            display: flex;
            align-items: center;
            font-size: 13px;
            cursor: pointer;
            transition: color 0.2s;
        }
        .action-icon {
            width: 18px; height: 18px;
            fill: currentColor;
            margin-right: 8px;
            padding: 6px;
            box-sizing: content-box;
            border-radius: 50%;
            transition: background 0.2s;
        }
        .action-item:hover.blue { color: var(--accent-blue); }
        .action-item:hover.blue .action-icon { background: rgba(29, 155, 240, 0.1); }
        .action-item:hover.green { color: var(--green-retweet); }
        .action-item:hover.green .action-icon { background: rgba(0, 186, 124, 0.1); }
        .action-item:hover.red { color: var(--red-like); }
        .action-item:hover.red .action-icon { background: rgba(249, 24, 128, 0.1); }

        .liked { color: var(--red-like) !important; }
        .liked svg { fill: var(--red-like); }

        /* --- RIGHT SIDEBAR --- */
        .right-sidebar {
            padding: 12px 24px;
            position: sticky;
            top: 0;
            height: 100vh;
        }
        
        .search-box {
            background-color: #202327;
            border-radius: 25px;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            border: 1px solid transparent;
        }
        .search-box:focus-within {
            background-color: black;
            border-color: var(--accent-blue);
        }
        .search-icon { width: 18px; height: 18px; fill: var(--text-secondary); margin-right: 12px; }
        .search-input {
            background: transparent;
            border: none;
            color: var(--text-main);
            outline: none;
            width: 100%;
        }

        .widget {
            background-color: #16181c;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
        }
        .widget-header { font-size: 20px; font-weight: 800; margin-bottom: 12px; }
        .trend-item {
            padding: 8px 0;
            cursor: pointer;
        }
        .trend-meta { font-size: 13px; color: var(--text-secondary); }
        .trend-name { font-weight: 700; margin: 2px 0; }
        
        .follow-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        .follow-avatar { width: clamp(32px,4.6vw,48px); height: clamp(32px,4.6vw,48px); border-radius: 50%; margin-right: 10px; object-fit: cover; }
        .follow-info { flex: 1; }
        .follow-btn {
            background-color: var(--text-main);
            color: black;
            font-weight: 600;
            padding: 6px 16px;
            border-radius: 18px;
            font-size: 14px;
        }
        .follow-btn:hover { opacity: 0.9; }

        /* --- LOADING SPINNER --- */
        .spinner {
            border: 3px solid rgba(29, 155, 240, 0.3);
            border-radius: 50%;
            border-top: 3px solid var(--accent-blue);
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: none;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* --- TYPING INDICATOR --- */
        .typing-container {
            display: flex;
            align-items: center;
            padding: 10px 0;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background-color: var(--text-secondary);
            border-radius: 50%;
            margin: 0 3px;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Specific style for the loading tweet to look 'ghostly' */
        .tweet.loading-state {
            border-bottom: none;
            opacity: 0.8;
        }

    </style>
</head>
<body>

<div class="layout">
    <header class="left-sidebar">
        <div>
            <div class="logo-box">
                <svg viewBox="0 0 24 24" class="logo-svg"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
            </div>
            
            <nav class="nav-links">
                <a href="#" class="nav-item active">
                    <svg viewBox="0 0 24 24" class="nav-icon"><path d="M22 23h-6.001a1 1 0 0 1-1-1v-5.455a2.997 2.997 0 1 0-5.998 0V22a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V11.543a1.002 1.002 0 0 1 .31.724l10-9.543a1.001 1.001 0 0 1 1.38 0l10 9.543a1.002 1.002 0 0 1 .31.724V22a1 1 0 0 1-1 1Z"></path></svg>
                    <span class="nav-label">Home</span>
                </a>
                <a href="#" class="nav-item">
                    <svg viewBox="0 0 24 24" class="nav-icon"><path d="M9.75 12.75a2.25 2.25 0 1 1 3 2.126V15.5A.75.75 0 0 1 12 16.25a.75.75 0 0 1-.75-.75v-1.127a3.001 3.001 0 0 0-1.5-5.623Z M12.001 2.25a.75.75 0 0 1 .75.75v1.27a8.955 8.955 0 0 1 7.429 7.43l1.269.001a.75.75 0 0 1 0 1.5l-1.27.001a8.953 8.953 0 0 1-6.678 6.678v2.62a.75.75 0 0 1-1.5 0v-2.62a8.953 8.953 0 0 1-6.679-6.678l-1.269-.001a.75.75 0 0 1 0-1.5l1.27-.001a8.955 8.955 0 0 1 7.429-7.43V3a.75.75 0 0 1 .75-.75Z"></path></svg>
                    <span class="nav-label">Explore</span>
                </a>
                <a href="#" class="nav-item">
                    <svg viewBox="0 0 24 24" class="nav-icon"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></svg>
                    <span class="nav-label">Notifications</span>
                </a>
                <a href="#" class="nav-item">
                    <svg viewBox="0 0 24 24" class="nav-icon"><path d="M12.001 2.25a.75.75 0 0 1 .75.75v1.27a8.955 8.955 0 0 1 7.429 7.43l1.269.001a.75.75 0 0 1 0 1.5l-1.27.001a8.953 8.953 0 0 1-6.678 6.678v2.62a.75.75 0 0 1-1.5 0v-2.62a8.953 8.953 0 0 1-6.679-6.678l-1.269-.001a.75.75 0 0 1 0-1.5l1.27-.001a8.955 8.955 0 0 1 7.429-7.43V3a.75.75 0 0 1 .75-.75Z"></path></svg>
                    <span class="nav-label">Grok</span>
                </a>
                <a href="#" class="nav-item">
                    <svg viewBox="0 0 24 24" class="nav-icon"><path d="M5.651 19h12.698c-.337-1.8-1.023-3.21-1.945-4.19C15.318 13.65 13.838 13 12 13s-3.317.65-4.404 1.81c-.922.98-1.608 2.39-1.945 4.19zm14.225.483a.75.75 0 0 1-.75.75H4.874a.75.75 0 0 1-.745-.82c.456-2.9 1.636-5.11 3.29-6.87C9.28 10.566 11.535 9.5 12 9.5s2.72.66 4.58 3.04c1.654 1.76 2.833 3.97 3.29 6.87a.75.75 0 0 1-.744.82zM12 8a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"></path></svg>
                    <span class="nav-label">Profile</span>
                </a>
            </nav>

            <button class="tweet-btn-large">Post</button>
            <div class="tweet-btn-icon">
                <svg viewBox="0 0 24 24"><path d="M23 3c-6.62-.1-10.38 2.421-13.05 6.03C7.29 12.61 6 17.331 6 22h2c0-1.007.07-2.012.19-3H12c4.1 0 7.48-3.082 7.94-7.054C22.79 10.147 23.17 6.359 23 3zm-7 8h-1.5v2H16c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4v1h2v-1c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2z"></path></svg>
            </div>
        </div>
        
        <div style="padding: 12px; display: flex; align-items: center; margin-bottom: 20px; cursor: pointer;">
            <img src="https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png" class="user-avatar" alt="Me">
            <div style="flex: 1; display: none; @media(min-width: 1024px){ display: block; }">
                <div style="font-weight: 700;">User</div>
                <div style="color: var(--text-secondary);">@user</div>
            </div>
            <div style="display: none; @media(min-width: 1024px){ display: block; }">...</div>
        </div>
    </header>

    <main class="main-feed">
        <div class="feed-header">
            <div class="header-top">Home</div>
            <div class="header-tabs">
                <div class="tab-item active">
                    For you
                    <div class="tab-indicator"></div>
                </div>
                <div class="tab-item">Following</div>
            </div>
        </div>

        <div class="compose-box">
            <img src="https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png" class="user-avatar" alt="Me">
            <div class="compose-right">
                <textarea class="compose-input" id="compose-input" placeholder="What dialogue did you hear?!" rows="1"></textarea>
                <div class="compose-footer">
                    <div class="compose-icons">
                        <svg viewBox="0 0 24 24"><path d="M3 5.5C3 4.119 4.119 3 5.5 3h13C19.881 3 21 4.119 21 5.5v13c0 1.381-1.119 2.5-2.5 2.5h-13C4.119 21 3 19.881 3 18.5v-13zM5.5 5c-.276 0-.5.224-.5.5v9.086l3-3 3 3 5-5 3 3V5.5c0-.276-.224-.5-.5-.5h-13zM19 15.414l-3-3-5 5-3-3-3 3V18.5c0 .276.224.5.5.5h13c.276 0 .5-.224.5-.5v-3.086zM9.75 7C8.784 7 8 7.784 8 8.75s.784 1.75 1.75 1.75 1.75-.784 1.75-1.75S10.716 7 9.75 7z"></path></svg>
                        <svg viewBox="0 0 24 24"><path d="M3 5v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2zm2 0h14v14H5V5zm7 2c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0 8c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"></path></svg>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <div class="spinner" id="spinner" style="margin-right: 10px;"></div>
                        <button class="post-btn" id="post-btn">Post</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="feed-stream">
            <article class="tweet">
                <img src="assets/remote/sheldon_03090030.jpg" class="user-avatar" style="background-color: #555;" onerror="this.src='https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png'">
                <div class="tweet-content">
                    <div class="tweet-header">
                        <span class="user-name">Sheldon Cooper</span>
                        <span class="user-handle">@dr_sheldon_cooper</span>
                        <span class="time">· 2h</span>
                    </div>
                    <div class="tweet-text">I'm not crazy, my mother had me tested.</div>
                    <div class="tweet-actions">
                        <div class="action-item blue"><svg class="action-icon" viewBox="0 0 24 24"><path d="M1.751 10c0-4.42 3.584-8 8.005-8h4.366c4.49 0 8.129 3.64 8.129 8.13 0 2.96-1.607 5.68-4.196 7.11l-8.054 4.46v-3.69h-.067c-4.49.1-8.183-3.51-8.183-8.01zm8.005-6c-3.317 0-6.005 2.69-6.005 6 0 3.37 2.77 6.08 6.138 6.01l.351-.01h1.761v2.3l5.087-2.81c1.951-1.08 3.163-3.13 3.163-5.36 0-3.39-2.744-6.13-6.129-6.13H9.756z"></path></svg> 24</div>
                        <div class="action-item green"><svg class="action-icon" viewBox="0 0 24 24"><path d="M4.5 3.88l4.432 4.14-1.364 1.46L5.5 7.55V16c0 1.1.896 2 2 2H13v2H7.5c-2.209 0-4-1.79-4-4V7.55L1.432 9.48.068 8.02 4.5 3.88zM16.5 6H11V4h5.5c2.209 0 4 1.79 4 4v8.45l2.068-1.93 1.364 1.46-4.432 4.14-4.432-4.14 1.364-1.46 2.068 1.93V8c0-1.1-.896-2-2-2z"></path></svg> 5</div>
                        <div class="action-item red" onclick="toggleLike(this)"><svg class="action-icon" viewBox="0 0 24 24"><path d="M16.697 5.5c-1.222-.06-2.679.51-3.89 2.16l-.805 1.09-.806-1.09C9.984 6.01 8.526 5.44 7.304 5.5c-1.243.07-2.349.78-2.91 1.91-.552 1.12-.633 2.78.479 4.82 1.074 1.97 3.257 4.27 7.129 6.61 3.87-2.34 6.052-4.64 7.126-6.61 1.111-2.04 1.03-3.7.477-4.82-.561-1.13-1.666-1.84-2.908-1.91zm4.187 7.69c-1.351 2.48-4.001 5.12-8.379 7.67l-.503.3-.504-.3c-4.379-2.55-7.029-5.19-8.382-7.67-1.36-2.5-1.41-4.86-.514-6.67.887-1.79 2.647-2.91 4.601-3.01 1.651-.09 3.368.56 4.798 2.01 1.429-1.45 3.146-2.1 4.796-2.01 1.954.1 3.714 1.22 4.605 3.01.894 1.81.844 4.17-.518 6.67z"></path></svg> 1.2K</div>
                        <div class="action-item"><svg class="action-icon" viewBox="0 0 24 24"><path d="M8.75 21V3h2v18h-2zM18 21V8.5h2V21h-2zM4 21l.004-10h2L6 21H4zm9.248 0v-7h2v7h-2z"></path></svg> 12K</div>
                    </div>
                </div>
            </article>
        </div>
    </main>

    <aside class="right-sidebar">
        <div class="search-box">
            <svg class="search-icon" viewBox="0 0 24 24"><path d="M10.25 3.75c-3.59 0-6.5 2.91-6.5 6.5s2.91 6.5 6.5 6.5c1.795 0 3.419-.726 4.596-1.904 1.178-1.177 1.904-2.801 1.904-4.596 0-3.59-2.91-6.5-6.5-6.5zm-8.5 6.5c0-4.694 3.806-8.5 8.5-8.5s8.5 3.806 8.5 8.5c0 1.986-.73 3.815-1.945 5.207l4.72 4.72c.39.39.39 1.023 0 1.414-.195.195-.451.293-.707.293s-.512-.098-.707-.293l-4.72-4.72c-1.391 1.216-3.221 1.945-5.207 1.945-4.694 0-8.5-3.806-8.5-8.5z"></path></svg>
            <input type="text" class="search-input" placeholder="Search">
        </div>

        <div class="widget">
            <div class="widget-header">Trends for you</div>
            <div class="trend-item">
                <div class="trend-meta">Technology · Trending</div>
                <div class="trend-name">#ArtificialIntelligence</div>
                <div class="trend-meta">54.2K posts</div>
            </div>
            <div class="trend-item">
                <div class="trend-meta">Entertainment · Trending</div>
                <div class="trend-name">Big Bang Theory</div>
                <div class="trend-meta">20.1K posts</div>
            </div>
            <div class="trend-item">
                <div class="trend-meta">Science · Trending</div>
                <div class="trend-name">String Theory</div>
                <div class="trend-meta">10.5K posts</div>
            </div>
        </div>

        <div class="widget">
            <div class="widget-header">Who to follow</div>
            <div class="follow-item">
                <img src="assets/remote/penny_01c8fefd.jpg" class="follow-avatar" onerror="this.src='https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png'">
                <div class="follow-info">
                    <div style="font-weight: 700;">Penny</div>
                    <div style="color: var(--text-secondary); font-size: 13px;">@penny_hofstadter</div>
                </div>
                <button class="follow-btn">Follow</button>
            </div>
            <div class="follow-item">
                <img src="assets/remote/leonard_01372120.jpg" class="follow-avatar" onerror="this.src='https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png'">
                <div class="follow-info">
                    <div style="font-weight: 700;">Leonard</div>
                    <div style="color: var(--text-secondary); font-size: 13px;">@leonard_h</div>
                </div>
                <button class="follow-btn">Follow</button>
            </div>
        </div>
    </aside>
</div>

<script>
    // --- DOM ELEMENTS ---
    const composeInput = document.getElementById('compose-input');
    const postBtn = document.getElementById('post-btn');
    const feedStream = document.getElementById('feed-stream');
    const spinner = document.getElementById('spinner');

    // --- STATE ---
    let isProcessing = false;

    // --- AUTO RESIZE TEXTAREA ---
    composeInput.addEventListener('input', function() {
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
        
        // Enable/Disable Button
        if (this.value.trim().length > 0) {
            postBtn.classList.add('active');
        } else {
            postBtn.classList.remove('active');
        }
    });

    // --- POST ACTION ---
    postBtn.addEventListener('click', async () => {
        if (isProcessing) return;
        const text = composeInput.value.trim();
        if (!text) return;

        // 1. UI Updates: Disable input, show spinner in button
        isProcessing = true;
        postBtn.classList.remove('active');
        composeInput.disabled = true;
        spinner.style.display = 'block';

        // 2. Render User's Post Immediately
        const userTweetId = Date.now();
        renderTweet(text, 'User', '@user', 'Just now', 'https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png', false, userTweetId);

        // Clear Input
        composeInput.value = '';
        composeInput.style.height = 'auto';

        // 3. SHOW TYPING INDICATOR IN FEED
        const loadingElement = showTypingIndicator();

        // 4. Call Backend API (Simulated)
        try {
            const response = await fetch('/api/predict', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ query: text, min_confidence: 0.2 })
            });

            if (!response.ok) throw new Error('API Error');
            const data = await response.json();

            // Process Character Data
            const charName = data.prediction || 'Unknown';
            let charImg = data.local_image || data.image;
            if (!charImg) charImg = `assets/${charName.toLowerCase().replace(/[^a-z0-9]/g, '_')}.svg`; 

            const replyText = getCharacterReply(charName);
            
            // Artificial delay to let the user see the "typing" animation
            setTimeout(() => {
                // REMOVE TYPING INDICATOR
                if(loadingElement) loadingElement.remove();

                // Add Real Reply
                renderTweet(replyText, charName, `@${charName.replace(' ', '_').toLowerCase()}`, '1s', charImg, true, null, userTweetId);
                finishPost();
            }, 1500); // Increased delay slightly for effect

        } catch (error) {
            console.error(error);
            // Fallback for demo
            setTimeout(() => {
                if(loadingElement) loadingElement.remove(); // Remove indicator
                renderTweet("I couldn't reach the server, but that sounded like Sheldon.", "System", "@server_bot", "1s", "", true, null, userTweetId);
                finishPost();
            }, 1000);
        }
    });

    function finishPost() {
        isProcessing = false;
        spinner.style.display = 'none';
        composeInput.disabled = false;
        composeInput.focus();
    }

    // --- NEW FUNCTION: RENDER TYPING INDICATOR ---
    function showTypingIndicator() {
        const article = document.createElement('article');
        article.className = 'tweet loading-state';
        
        // We use a generic "system" avatar or transparent one for the loading state
        article.innerHTML = `
            <div class="user-avatar" style="background: transparent;"></div>
            <div class="tweet-content">
                <div class="tweet-header">
                    <span class="user-name" style="color: var(--text-secondary);">Identifying character</span>
                </div>
                <div class="typing-container">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
        `;
        
        // Insert at the top of the feed (before the user's post moves down, or right after it)
        feedStream.insertBefore(article, feedStream.firstChild);
        return article; // Return element so we can remove it later
    }

    // --- RENDER TWEET FUNCTION ---
    function renderTweet(text, name, handle, time, avatarUrl, isReply, id, replyToId) {
        const article = document.createElement('article');
        article.className = 'tweet';
        if (isReply) article.classList.add('reply');
        
        // Handle missing images gracefully
        const safeAvatar = avatarUrl || 'https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png';

        const html = `
            ${!isReply && id ? `<div class="thread-line" id="line-${id}"></div>` : ''}
            <img src="${safeAvatar}" class="user-avatar" onerror="this.src='https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png'">
            <div class="tweet-content">
                <div class="tweet-header">
                    <span class="user-name">${name}</span>
                    <span class="user-handle">${handle}</span>
                    <span class="time">· ${time}</span>
                </div>
                <div class="tweet-text">${text}</div>
                <div class="tweet-actions">
                    <div class="action-item blue"><svg class="action-icon" viewBox="0 0 24 24"><path d="M1.751 10c0-4.42 3.584-8 8.005-8h4.366c4.49 0 8.129 3.64 8.129 8.13 0 2.96-1.607 5.68-4.196 7.11l-8.054 4.46v-3.69h-.067c-4.49.1-8.183-3.51-8.183-8.01zm8.005-6c-3.317 0-6.005 2.69-6.005 6 0 3.37 2.77 6.08 6.138 6.01l.351-.01h1.761v2.3l5.087-2.81c1.951-1.08 3.163-3.13 3.163-5.36 0-3.39-2.744-6.13-6.129-6.13H9.756z"></path></svg> 0</div>
                    <div class="action-item green"><svg class="action-icon" viewBox="0 0 24 24"><path d="M4.5 3.88l4.432 4.14-1.364 1.46L5.5 7.55V16c0 1.1.896 2 2 2H13v2H7.5c-2.209 0-4-1.79-4-4V7.55L1.432 9.48.068 8.02 4.5 3.88zM16.5 6H11V4h5.5c2.209 0 4 1.79 4 4v8.45l2.068-1.93 1.364 1.46-4.432 4.14-4.432-4.14 1.364-1.46 2.068 1.93V8c0-1.1-.896-2-2-2z"></path></svg> 0</div>
                    <div class="action-item red" onclick="toggleLike(this)"><svg class="action-icon" viewBox="0 0 24 24"><path d="M16.697 5.5c-1.222-.06-2.679.51-3.89 2.16l-.805 1.09-.806-1.09C9.984 6.01 8.526 5.44 7.304 5.5c-1.243.07-2.349.78-2.91 1.91-.552 1.12-.633 2.78.479 4.82 1.074 1.97 3.257 4.27 7.129 6.61 3.87-2.34 6.052-4.64 7.126-6.61 1.111-2.04 1.03-3.7.477-4.82-.561-1.13-1.666-1.84-2.908-1.91zm4.187 7.69c-1.351 2.48-4.001 5.12-8.379 7.67l-.503.3-.504-.3c-4.379-2.55-7.029-5.19-8.382-7.67-1.36-2.5-1.41-4.86-.514-6.67.887-1.79 2.647-2.91 4.601-3.01 1.651-.09 3.368.56 4.798 2.01 1.429-1.45 3.146-2.1 4.796-2.01 1.954.1 3.714 1.22 4.605 3.01.894 1.81.844 4.17-.518 6.67z"></path></svg> <span class="like-count">0</span></div>
                    <div class="action-item"><svg class="action-icon" viewBox="0 0 24 24"><path d="M8.75 21V3h2v18h-2zM18 21V8.5h2V21h-2zM4 21l.004-10h2L6 21H4zm9.248 0v-7h2v7h-2z"></path></svg> 0</div>
                </div>
            </div>
        `;
        article.innerHTML = html;

        // Insert logic: Newest at top
        if (replyToId) {
            feedStream.insertBefore(article, feedStream.firstChild);
        } else {
            feedStream.insertBefore(article, feedStream.firstChild);
        }
    }

    // --- LIKE TOGGLE ---
    window.toggleLike = function(el) {
        el.classList.toggle('liked');
        const countSpan = el.querySelector('.like-count');
        let count = parseInt(countSpan.innerText.replace(/,/g, ''));
        if (isNaN(count)) count = 0;
        
        if (el.classList.contains('liked')) {
            count++;
        } else {
            count--;
        }
        countSpan.innerText = count;
    }

    // --- RANDOM REPLIES ---
    function getCharacterReply(name) {
        // Normalize name to lowercase for easier matching
        const cleanName = name.toLowerCase();

        const replies = {
            sheldon: [
                "Bazinga! I fooled you.",
                "That is my spot. And that is my line.",
                "I'm not crazy, my mother had me tested.",
                "Please, I have a master's degree and two doctorates. Of course I said that.",
                "In the world of minions, I am the Gru. That is my dialogue.",
                "It's a non-optional social convention that you credit me for that quote.",
                "Oh, gravity, thou art a heartless bitch. (Also, I said that)."
            ],
            leonard: [
                "Yeah, yeah, I said it. Can we go now?",
                "Why does everything always have to be about Sheldon?",
                "I did say that. And I regret it immediately.",
                "That sounds like something I'd say while Penny is ignoring me.",
                "Sarcasm sign? No? Okay, yes, that was me.",
                "I put up with a lot, but yes, that is my line."
            ],
            penny: [
                "Holy crap on a cracker, I actually said that?",
                "I need a glass of wine to deal with this.",
                "Yeah, I said it. Don't look at me like I'm stupid.",
                "Is that a science thing? Because I definitely said it.",
                "Knock, knock, knock. Penny. That's me.",
                "Sweetie, I say a lot of things."
            ],
            howard: [
                "I went to space! Of course I said something that cool.",
                "That's the engineer talking. MIT, baby!",
                "Did my mother tell you that? BECAUSE I AM AN ASTRONAUT.",
                "That line works on all the ladies. Trust me.",
                "I believe the term you are looking for is 'Wolowitzed'.",
                "Bernadette would kill me if she knew I repeated that."
            ],
            raj: [
                "(Whispers in ear) *He says he definitely said that.*",
                "I'm comfortable with my masculinity, and I stand by that quote.",
                "That was beautiful. Like a Bollywood movie.",
                "My father paid a lot of money for me to say that.",
                "Did you know I have a dog named Cinnamon? Also, yes, I said that.",
                "Please don't send me back to India, I am being witty!"
            ],
            amy: [
                "According to my research, that is indeed my utterance.",
                "I find your obsession with my quotes... titillating.",
                "Sheldon, look! They are quoting me!",
                "That is scientifically accurate and socially awkward. Definitely me.",
                "My hippocampus retains the memory of saying exactly that."
            ]
        };

        // Generic fallback for unknown characters
        const generic = [
            "I believe that was my line.",
            "Yes, I recall saying that.",
            "That sounds exactly like me.",
            "You have excellent hearing. That was me.",
            "A quote attributed to me? Fascinating.",
            "Indeed."
        ];

        // 1. Check if we have specific lines for this character
        const characterKey = Object.keys(replies).find(key => cleanName.includes(key));

        // 2. Select the array (specific or generic)
        const pool = characterKey ? replies[characterKey] : generic;

        // 3. Return a random item from the selected pool
        return pool[Math.floor(Math.random() * pool.length)];
    }

</script>

</body>
</html>